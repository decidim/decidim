<%= link_to("<< Change election", voting_monitoring_committee_polling_station_closures_path(current_voting)) unless elections.one? %>

<div class="card" id="monitoring_committee_polling_station_closures">
  <div class="card-divider">
    <h2 class="card-title">
      <%= t(".title", election_title: translated_attribute(election.title)).html_safe %>
    </h2>
  </div>

  <%= admin_filter_selector %>

  <div class="card-section">
    <div class="table-scroll">
      <table class="table-list">
        <thead>
          <tr>
            <th><%= t("models.polling_station.fields.title", scope: "decidim.votings.admin") %></th>
            <th><%= t("models.polling_station.fields.address", scope: "decidim.votings.admin") %></th>
            <th><%= t(".signed") %></th>
            <th><%= t(".verified") %></th>
            <th class="actions"><%= t("actions.title", scope: "decidim.votings.polling_stations") %></th>
          </tr>
        </thead>
        <tbody>
          <% filtered_polling_stations.each do |polling_station| %>
            <%
              closure = polling_station.closure_for(election)
              sign_icon_name, sign_icon_style = closure.present? ? ["check", "polling_station__closure--present"] : ["x", "polling_station__closure--not_present"]
              verified_icon_name, verified_icon_style = closure&.verified? ? ["check", "polling_station__closure--verified"] : ["x", "polling_station__closure--not_verified"]
            %>
            <tr <%= "data-id='#{closure.id}'" if closure.present? %> >
              <td>
                <%= translated_attribute(polling_station.title) %>
              </td>
              <td>
                <%= polling_station.address %>
              </td>
              <td>
                <%= icon sign_icon_name, class: sign_icon_style %>
              </td>
              <td>
                <%= icon verified_icon_name, class: verified_icon_style %>
              </td>
              <td class="table-list__actions">
                <% if closure.present? && allowed_to?(:read, :monitoring_committee_polling_station_closure, voting: current_voting, closure: closure) %>
                  <%= icon_link_to "eye", edit_voting_monitoring_committee_polling_station_closure_path(current_voting, closure), t("actions.edit", scope: "decidim.votings.polling_stations"), class: "action-icon--edit" %>
                <% else %>
                  <%= icon "eye", class: "action-icon action-icon--disabled", role: "img", aria_label: t("actions.edit", scope: "decidim.votings.polling_stations") %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
