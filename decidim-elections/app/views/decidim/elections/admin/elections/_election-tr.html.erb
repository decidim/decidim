<tr data-id="<%= election.id %>">
  <td>
    <% if allowed_to? :update, :election, election: election %>
      <%= link_to present(election).title(html_escape: true), election.published? ? dashboard_election_path(election) : edit_election_path(election) %>
    <% else %>
      <%= present(election).title(html_escape: true) %><br>
    <% end %>
  </td>
  <td>
    <% if election.start_at %>
      <%= l election.start_at, format: :long %>
      <% else %>
      <%= t("decidim.elections.admin.elections.form.manual_start") %>
    <% end %>
  </td>
  <td>
    <% if election.end_at %>
      <%= l election.end_at, format: :long %>
    <% end %>
  </td>
  <td>
    <%= election_status_with_label(election) %>
  </td>
  <td>
    <%= election.census.label %>
  </td>
  <td data-label="<%= t("actions.title", scope: "decidim.elections") %>" class="table-list__actions">
    <button type="button" data-component="dropdown" data-target="actions-election-<%= election.id %>" aria-label="<%= t("decidim.admin.actions.actions_label", resource: decidim_sanitize_translated(election.title)) %>">
      <%= icon "more-fill", class: "text-secondary" %>
    </button>

    <div class="inline-block relative">
      <ul id="actions-election-<%= election.id %>" class="dropdown dropdown__action" aria-hidden="true">
        <% if view == :deleted %>
          <% if allowed_to? :restore, :election, trashable_deleted_resource: election %>
            <li class="dropdown__item">
              <%= link_to url_for(action: :restore, id: election, controller: "elections"), class: "dropdown__button", method: :patch do %>
                <%= icon "refresh-line" %>
                <%= t("decidim.admin.actions.restore") %>
              <% end %>
            </li>
          <% end %>
        <% else %>
          <% if allowed_to? :update, :election, election: election %>
            <li class="dropdown__item">
              <%= link_to edit_election_path(election), class: "dropdown__button" do %>
                <%= icon "pencil-line" %>
                <%= t("actions.edit", scope: "decidim.elections") %>
              <% end %>
            </li>
            <hr>
          <% end %>

          <% if allowed_to? :publish, :election, election: election %>
            <li class="dropdown__item">
              <%= link_to publish_election_path(election), class: "dropdown__button", method: :put do %>
                <%= icon "check-line" %>
                <%= t("actions.publish", scope: "decidim.admin") %>
              <% end %>
            </li>
            <hr>
          <% end %>

          <% if allowed_to? :unpublish, :election, election: election %>
            <li class="dropdown__item">
              <%= link_to unpublish_election_path(election), class: "dropdown__button", method: :put, data: { confirm: t("actions.confirm_unpublish_election", scope: "decidim.elections") } do %>
                <%= icon "close-circle-line" %>
                <%= t("actions.unpublish", scope: "decidim.admin") %>
              <% end %>
            </li>
            <hr>
          <% end %>

          <li class="dropdown__item">
            <%= link_to resource_locator(election).path, class: "dropdown__button", target: :blank, data: { "external-link": false } do %>
              <%= icon "eye-line" %>
              <%= t("actions.preview", scope: "decidim.elections") %>
            <% end %>
          </li>
          <hr>

          <li class="dropdown__item">
            <% if allowed_to? :soft_delete, :election, trashable_deleted_resource: election %>
              <%= link_to soft_delete_election_path(election), class: "dropdown__button", method: :patch, data: { confirm: t("actions.confirm_delete_election", scope: "decidim.elections") } do %>
                <%= icon "delete-bin-line" %>
                <%= t("actions.soft_delete", scope: "decidim.admin") %>
              <% end %>
            <% end %>
          </li>
      <% end %>
      </ul>
    </div>
  </td>
</tr>
