<% add_decidim_page_title(t(".title")) %>
<div class="card">
  <div class="item_show__header">
    <h1 class="item_show__header-title">
      <%= t(".title") %>
      <%= link_to t("actions.new", scope: "decidim.collaborative_texts"), new_document_path, class: "button button__sm button__secondary" %>
      <%= render partial: "decidim/admin/components/resource_action" %>
    </h1>
  </div>
  <div class="table-scroll">
    <table class="table-list">
      <thead>
        <tr>
        <th><%= t("models.collaborative_text.fields.title", scope: "decidim.collaborative_texts") %></th>
        <th><%= t("actions.title", scope: "decidim.collaborative_texts") %></th>
        </tr>
      </thead>
      <tbody>
        <% documents.each do |document| %>
          <tr>
            <td><%= document.title %></td>
            <td class="table-list__actions">
                <%= icon_link_to "settings-4-line", edit_settings_document_path(document), t("actions.manage", scope: "decidim.collaborative_texts") %>
                <%= icon_link_to "pencil-line", edit_document_path(document), t("actions.edit", scope: "decidim.collaborative_texts"), class: "action-icon--edit" %>
                <%= icon_link_to "eye-line", resource_locator(document).path, t("actions.preview", scope: "decidim.admin"), class: "action-icon--preview", target: :blank, data: { "external-link": false } %>
                <% if document.published? %>
                  <%= icon_link_to "close-circle-line", unpublish_document_path(document), t("actions.unpublish", scope: "decidim.admin"), method: :put, class: "action-icon--unpublish" %>
                <% else %>
                  <%= icon_link_to "check-line", publish_document_path(document), t("actions.publish", scope: "decidim.admin"), method: :put, class: "action-icon--publish" %>
                <% end %>
                <% if allowed_to? :soft_delete, :collaborative_text , trashable_deleted_resource: document %>
                    <%= icon_link_to "delete-bin-line", soft_delete_document_path(document), t("actions.soft_delete", scope: "decidim.admin"), method: :patch, class: "action-icon--delete", data: { confirm: t("actions.confirm_delete_document", scope: "decidim.collaborative_texts") } %>
                <% else %>
                    <%= icon "delete-bin-line", class: "action-icon action-icon--disabled", role: "img", aria_label: t("actions.soft_delete", scope: "decidim.admin") %>
                <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <% if allowed_to? :manage_trash, :collaborative_text, participatory_space: current_participatory_space %>
    <div class="card mt-4">
      <%= link_to manage_trash_documents_path, class: "flex items-center underline text-secondary" do %>
        <%= icon "delete-bin-2-line", class: "mr-2 fill-current text-secondary", role: "img" %>
        <%= t("actions.view_deleted_documents", scope: "decidim.collaborative_texts") %>
        <span class="ml-2">
          <%= icon_with_tooltip("information-line", t("actions.deleted_document_info", scope: "decidim.collaborative_texts")) %>
        </span>
      <% end %>
    </div>
  <% end %>
</div>
