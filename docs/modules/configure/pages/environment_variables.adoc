= Environment Variables

We try to let most of the things defined through Environment Variables, as https://12factor.net/config[12factor applications's config]. You'll need to configure through your hosting provider (for example in Heroku), through a gem like `figaro` or through docker-compose `env_file`.

This is an extensive list of all the Env variables supported for an application created with the default `decidim` generator (ie: `decidim my-application`). Custom applications may modify or customize the default decidim initializer (`config/initializers/decidim.rb`) in such a a way that this will have no effect.

Finally, take into account that there are some config variables not available as Env vars, this is because it is not enough to set them in order to make that particular feature to work, it requires the user to add some custom code (usually a service class that acts a wrapper for an external API). These are the case for initializers such as `sms_gateway_service`, `timestamp_service`, `pdf_signature_service` or `machine_translation_service`. For more information about these extra services check the xref:configure:initializer.adoc[Initializer documentation].

The next tables show all the default Env Vars available when running a default Decidim application (note that customized Decidim apps might differ). The ones marked in *bold* are the minimal required to run a production server. The ones marked as _italic_ are only required for development.

.Required Decidim Env Vars
|===
|Name |Value |Default value|Multitenant's System configurable

|_DATABASE_HOST_
|Hostname for the Postgres database.
|localhost
|No

|_DATABASE_PASSWORD_
|Password for the Postgres database
|
|No

|_DATABASE_PORT_
|Port for the Postgres database.
|5432
|No

|_DATABASE_USERNAME_
|Username for the Postgres database. Note that database name is autogenerated in development mode thus there's no config var here.
|
|No

|*DATABASE_URL*
|For production environments database needs to be defined as a string following the scheme: `postgres://USERNAME:PASSWORD@HOST/DATABASE_NAME``
|
|No

|*RAILS_ENV*
|Environment for Ruby on Rails. If it's on your local machine for development, then it should be `development`. If it's on server it should be `production`. Please take care that this has security implications. You DON'T want to be running a production application on development mode.
|development
|No

|*SECRET_KEY_BASE*
|Secret key base for the Application. It's specially important that this is kept secret from the outside word; do NOT publish it on GitHub/GitLab/BitBucket.
|
|No

|*SMTP_ADDRESS*
|Hostname for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|
|*Yes*

|*SMTP_DOMAIN*
|Domain for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|
|*Yes*

|*SMTP_PASSWORD*
|Password for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|
|*Yes*

|*SMTP_USERNAME*
|Username for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|
|*Yes*

|*DECIDIM_APPLICATION_NAME*
|Default name (shown in the browser's title status and search engines) for the Decidim instance.
|My Application Name
|*Yes*

|*DECIDIM_MAILER_SENDER*
|Default Reply email for any email sent (transactional or newsletters).
|change-me@example.org
|*Yes*

|SMTP_PORT
|Port for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|587
|*Yes*

|SMTP_STARTTLS_AUTO
|Automatically use STARTTLS protocol for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|true
|*Yes*

|SMTP_AUTHENTICATION
|Type of authentication for the SMTP server, for sending emails. See xref:services:smtp.adoc[SMTP]
|plain
|*Yes*

|===

.Optional Decidim Env Vars for external services integrations
|===
|Name |Value |Default value|Multitenant's System configurable


|MAPS_PROVIDER
|For a simple geolocation and tile maps service configuration define this value to one of the supported providers, currently `here` for https://HERE.com[HERE Maps] or `osm` for https://www.openstreetmap.org[OpenStreatMap]. See xref:services:maps.adoc[Maps].
|
|No

|MAPS_API_KEY
|For a simple geolocation and tile maps service configuration define this value in case the provider needs it (if you are using Here Maps, you will need an API key). See xref:services:maps.adoc[Maps].

*Note that if you are using the `here` service you don't need to do anything else. If using `osm` however check the rest of env vars related to maps for a proper configuration*
|
|No

|MAPS_DYNAMIC_URL
|If you are using a `osm` as a provider, you need to define this variable. Keep in mind that OpenStreetMap cannot be used directly due its non-commercial license in many cases. See xref:services:maps.adoc[Maps].

*You need to define this variable if using `osm` as a provider, usually the URL goes in the form of `https://tile.openstreetmap.org/{z}/{x}/{y}.png?key={apiKey}&{foo}`*
|
|No

|MAPS_STATIC_URL
|If you are using a `osm` as a provider, you need to define this variable. Keep in mind that OpenStreetMap cannot be used directly due its non-commercial license in many cases. See xref:services:maps.adoc[Maps].

*You need to define this variable if using `osm` as a provider, usually the URL goes in the form of `http://staticmap.openstreetmap.de/`*
|https://image.maps.ls.hereapi.com/mia/1.6/mapview (only if using Here Maps)
|No

|MAPS_ATTRIBUTION
|If you are using a `osm` as a provider, you need to define this variable. OpenStreeMap requires you to show the credits and that's what this does. See xref:services:maps.adoc[Maps].

*You need to define this variable if using `osm` as a provider, the next text is a pretty common value: `<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap</a> contributors`*
|
|No

|MAPS_EXTRA_VARS
|Some providers may require you to send additional variables in the dynamic tile request (custom api keys, secrets, etc). Use this to do that, you can define as many pairs of "variable"/"value" in a URL-encoded string. See xref:services:maps.adoc[Maps].

*Note that to defined this variable might not be necessary in most cases, if you do it must look something like `api_key=true&foo=bar%3Dbaz`*
|
|No

|MAPS_GEOCODING_HOST
|If you are using a `osm` as a provider, you need to define this variable to define the geocoder service to to translate addresses into latitude/longitude coordinates. See xref:services:maps.adoc[Maps].

*You need to define this variable if using `osm` as a provider, usually the URL goes in the form of `https://nominatim.openstreetmap.org`*
|
|No

|MAPS_DYNAMIC_PROVIDER
|For advanced cases, you can define this value instead or in combination of MAPS_PROVIDER (which will be the default). This allows to set up different providers for the static tile provider than the dynamic. See xref:services:maps.adoc[Maps].

*Note that you don't need to define this variable for the most common, simple, one provider cases.*
|
|No

|MAPS_STATIC_PROVIDER
|For advanced cases, you can define this value instead or in combination of MAPS_PROVIDER (which will be the default). This allows to set up different providers for the static tile provider than the dynamic. See xref:services:maps.adoc[Maps].

*Note that you don't need to define this variable for the most common, simple, one provider cases.*
|
|No

|MAPS_STATIC_API_KEY
|For advanced cases, you can define this value instead or in combination of MAPS_API_KEY (which will be the default). This allows to set up different providers for the static tile provider than the dynamic requiring different API KEYS. See xref:services:maps.adoc[Maps].

*Note that you don't need to define this variable for the most common, simple, one provider cases.*
|
|No

|MAPS_DYNAMIC_API_KEY
|For advanced cases, you can define this value instead or in combination of MAPS_API_KEY (which will be the default). This allows to set up different providers for the static tile provider than the dynamic requiring different API KEYS. See xref:services:maps.adoc[Maps].

*Note that you don't need to define this variable for the most common, simple, one provider cases.*
|
|No

|ETHERPAD_SERVER
|URL for an https://etherpad.org/[Etherpad.org] server to integrate in Decidim for collaborative, real time writing events. See xref:services:etherpad.adoc[Etherpad].
|
|No

|ETHERPAD_API_KEY
|API key for communicating with the Etherpad server. See xref:services:etherpad.adoc[Etherpad].
|
|No

|ETHERPAD_API_VERSION
|Etherpad API version, this is unlikely to be needed to be changed. See xref:services:etherpad.adoc[Etherpad].
|1.2.1
|No

|OMNIAUTH_FACEBOOK_APP_ID
|App ID for enabling access through Facebook.com accounts. See xref:services:social_providers.adoc[Social Providers]. Note that defining this variable automatically renders the "login with" button.
|
|*Yes*

|OMNIAUTH_FACEBOOK_APP_SECRET
|App Secret for enabling access through Facebook.com accounts. See xref:services:social_providers.adoc[Social Providers].
|
|*Yes*

|OMNIAUTH_GOOGLE_CLIENT_ID
|Client ID for enabling access through Google.com accounts. See xref:services:social_providers.adoc[Social Providers].
|
|*Yes*

|OMNIAUTH_GOOGLE_CLIENT_SECRET
|Client Secret for enabling access through Google.com accounts. See xref:services:social_providers.adoc[Social Providers].
|
|*Yes*

|OMNIAUTH_TWITTER_API_KEY
|API Key for enabling access through Twitter.com accounts. See xref:services:social_providers.adoc[Social Providers].
|
|*Yes*

|OMNIAUTH_TWITTER_API_SECRET
|API Secret for enabling access through Twitter.com accounts. See xref:services:social_providers.adoc[Social Providers].
|
|*Yes*

|BULLETIN_BOARD_SERVER
|The full URL to identify a https://github.com/decidim/decidim-bulletin-board[Bulletin Board Server]. *It must point to the Graphql API* (ie: https://bulletinboard.example.org/api) See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|BULLETIN_BOARD_PUBLIC_KEY
|The public RSA key used to verify the Bulletin Board Server. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|BULLETIN_BOARD_API_KEY
|An additional API key to add additional security with the comunications with the Elections Bulletin Board Server. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|AUTHORITY_NAME
|The name of the Authority registered in the Bulletin Board Server corresponding to this Decidim instance. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|AUTHORITY_PRIVATE_KEY
|The private RSA key of this Decidim instance corresponding to the Authority public key registered in the Bulletin Board Server. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|ELECTIONS_SCHEME_NAME
|The type of strategy used in the Bulletin Board Server used for encrypting the Election. *Currently only `electionguard` is available for production* See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|electionguard
|No

|ELECTIONS_NUMBER_OF_TRUSTEES
|Number of trustees for `electionguard` election scheme, minimum number is 2. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|ELECTIONS_QUORUM
|Number of trustees required to be present in order to decrypt an election in case of the `electionguard` scheme. Minimum is 2, maximum the number os trustees. See xref:services:elections_bulletin_board.adoc[Elections Bulletin Board].
|
|No

|VAPID_PUBLIC_KEY
|VAPID public key that will be used to sign the Push API requests. It can be generated running the task: `rake decidim:generate_vapid_keys`
|
|No

|VAPID_PRIVATE_KEY
|VAPID private key that will be used to sign the Push API requests. It can be generated running the task: `rake decidim:generate_vapid_keys`
|
|No

|===

.Additional Optional Decidim Env Vars for the setting up the application
|===
|Name |Value |Default value|Multitenant's System configurable

|DECIDIM_AVAILABLE_LOCALES
|a list of, coma separated, locales that will be available for each organization configured in the System configuration. Check for the https://github.com/decidim/decidim/blob/3d4ec74bdce406e2ee6934b830d3c06398ab72c0/decidim-core/lib/decidim/core.rb#L166[Supported values] in ISO639 format.

*Be careful while setting up this value, you can easily shoot yourself in the food as Decidim will crash if one of the languages is not supported*
|ca, cs, de, en, es, eu, fi, fr, it, ja, nl, pl, pt, ro
|*Partially*, Only when creating a new organization the admin needs to choose between these values

|DECIDIM_DEFAULT_LOCALE
|The default locale to be used as a fallback (note that, in practice, this value must always be defined in the System configuration for each organization anyway).

*Note that `DECIDIM_AVALABLE_LOCALES` must include this value*
|en
|*Partially*, Only when creating a new organization

|DECIDIM_FORCE_SSL
|By default, Decidim enforces a SSL connection (https), sometimes it is necessary to disable it in order to handle this through a proxy system (note that use Decidim without SSL at all is NOT RECOMMENDED). This value can take 3 values:

`auto`: Will be `true` for Rails Production or Staging environments and `false` for development or test. If undefined, defaults to this value.

`true`: Will redirect to HTTPS always

`false`: Won't redirect to HTTPS

|auto
|No

|DECIDIM_ENABLE_HTML_HEADER_SNIPPETS
|Set to `true` in order to allow administrators to define an arbitrary custom HTML code in the `<head></head>` section any Decidim page.

The most common use is to integrate third-party services that require some
extra JavaScript or CSS. Also, you can use it to add extra meta tags to the
HTML. Note that this will only be rendered in public pages, not in the admin
section.

Before enabling this you should ensure that any tracking that might be done
is in accordance with the rules and regulations that apply to your
environment and usage scenarios. This component also comes with the risk
that an organization's administrator injects malicious scripts to spy on or
take over user accounts.
|
|No

|DECIDIM_CURRENCY_UNIT
|Currency unit is used in view showing monetary actions, such as budgets. It does not affect any internal calculations.
|€
|No

|DECIDIM_CORS_ENABLED
|The SVG do not support CORS. When using custom asset host different than root url, set this value to `true`, in order to activate the available workaround.
|false
|No

|DECIDIM_IMAGE_UPLOADER_QUALITY
|Defines the quality of image uploads after processing. Image uploads are processed by Decidim, this value helps reduce the size of the files.
|80
|No

|DECIDIM_MAXIMUM_ATTACHMENT_SIZE
|The maximum file size of an attachment (in Megabytes).

Mind that this depends on your environment, for instance you could also need to change your web server configuration (nginx, apache, etc).
|10
|*Yes*

|DECIDIM_MAXIMUM_AVATAR_SIZE
|The maximum file size for a user avatar (in Megabytes).

Mind that this depends on your environment, for instance you could also need to change your web server configuration (nginx, apache, etc).
|5
|*Yes*

|DECIDIM_MAX_REPORTS_BEFORE_HIDING
|The number of reports which a resource can receive before hiding it. This affects moderations for resources such as proposals or users (spammers).
|3
|No

|DECIDIM_TRACK_NEWSLETTER_LINKS
|Allow organizations admins to track newsletter links, trough UTMs. See https://en.wikipedia.org/wiki/UTM_parameters[UTM parameters in Wikipedia]. Set it to `true` or `false`, if undefined defaults to `true`.
|true
|No

|DECIDIM_DATA_PORTABILITY_EXPIRY_TIME
|Number of days that the data portability files will be available in the server.
|7
|No

|DECIDIM_THROTTLING_MAX_REQUESTS
|Max requests in a time period to prevent DoS attacks. Only applied on production. Note that this is used by the Gem https://github.com/rack/rack-attack#throttlename-options-block[Rack::Attack] and blocks are based on the detected remote IP. Different proxy configurations (such as load balancers) may affect this, we recommend to read the documentation for this gem.
|100
|No

|DECIDIM_THROTTLING_PERIOD
|Time window (in number of minutes) in which the throttling is applied.
|1
|No

|DECIDIM_UNCONFIRMED_ACCESS_FOR
|Time window (in number of days) were users can access the website even if their email is not confirmed.
|0
|No

|DECIDIM_SYSTEM_ACCESSLIST_IPS
|For extra security, restrict access to the system part with an authorized ip list.

You can use a single ip like `1.2.3.4`, or an ip subnet like `1.2.3.4/24`
You may specify multiple ip in an array, separating by commas, such as `1.2.3.4, 1.2.3.4/24`
|
|No

|DECIDIM_BASE_UPLOADS_PATH
|A base path for the uploads. If set, make sure it ends in a slash.
Uploads will be set to `<base_path>/uploads/`. This can be useful if you
want to use the same uploads place for both staging and production
environments, but in different folders.

If not set, it will be ignored.
|
|No

|DECIDIM_DEFAULT_CSV_COL_SEP
|Sets Decidim::Exporters::CSV's default column separator. This is used in general in any activity that generates a CSV file.
|;
|No

|DECIDIM_CONSENT_COOKIE_NAME
|Defines the name of the cookie used to check if the user allows Decidim to set cookies. This is needed due the GDPR regulations.
|decidim-cc
|No

|DECIDIM_EXPIRE_SESSION_AFTER
|In minutes, How long can a user remained logged in before the session expires.

Notice that this is also maximum time that user can idle before getting automatically signed out.
|30
|No

|DECIDIM_ENABLE_REMEMBER_ME
|If set to true, users have option to "remember me".

Notice that expire_session_after won't take effect when the user wants to be remembered.
|true
|No

|DECIDIM_SESSION_TIMEOUT_INTERVAL
|In seconds, defines how often `session_timeouter.js` checks time between the current moment and the last request. This is a periodic poll method (performed by a JS script) that is used to show users an alert that the session is about to expire after a period of inactivity.
|10
|No

|DECIDIM_FOLLOW_HTTP_X_FORWARDED_HOST
|Exposes a configuration option: `HTTP_X_FORWADED_HOST` header follow-up.

If a caching system is in place, it can also allow cache and log poisoning attacks, allowing attackers to control the contents of caches and logs that could be used for other attacks.
|false
|No

|DECIDIM_MAXIMUM_CONVERSATION_MESSAGE_LENGTH
|The maximum length (number of characters) for conversation messages. Conversations are private threads between two or more users or groups.

This does not affect comments as its length can be configured by administrators in the component's settings.
|1000
|No

|DECIDIM_PASSWORD_BLACKLIST
|Blacklisted passwords. Array may contain strings and regex entries.

Separate each item of the array with a comma AND a space, for instance:
`i-dont-like-this-password, i-dont-like-this-one-either, password123456`
|
|No

|DECIDIM_ALLOW_OPEN_REDIRECTS
|Disable the redirection to the external host when performing redirect back.

*This is not recommended to activate unless you know what you are doing*

More details at https://github.com/rails/rails/issues/39643[Rails issue #39643]

Additional context: This has been revealed as an issue during a security audit on Future of Europe installation

|false
|No

|===

.Optional Env Vars for extra Rails configuration
|===
|Name |Value |Default value|Multitenant's System configurable

|RAILS_LOG_TO_STDOUT
|If defined (value is indifferent) it'll show the log content on the shell Standard Out. It's special relevant on certain hosting providers (for example, Heroku or Docker). It's also part of https://12factor.net/logs[12factor's recommendations].
|
|No

|RAILS_SERVE_STATIC_FILES
|If defined (value is indifferent) it'll serve static files present in the `public` folder of Rails. It's special relevant on certain hosting providers (for example, Heroku or Docker).
|
|No

|RAILS_LOG_LEVEL
|The log level for the application. This makes more or less verbose the logger. Usually, it is a good choice to use `info` after a period of testing a production application.

It must be one of these: `debug`, `info`, `warn`, `error`, `fatal`

Note that this only applies to production environments.
|debug
|No

|RAILS_ASSET_HOST
|If you use a CDN or another type of assets management, you can specify the host (and path) for it so, instead of Rails serving your assets (CSS, Javascript, Images) will use your custom system. For instance `https://assets.example.org`
|
|No

|PORT
|Specifies the `port` that Puma will listen on to receive requests. This does not apply to alternative application servers such as Passenger.
|3000
|No

|RAILS_MAX_THREADS
|Specifies the maximum number of concurrent database connections and `threads` that Puma will use to serve requests. Please refer to http://guides.rubyonrails.org/configuring.html#database-pooling[Database pooling at Rails Guides] for more information.
|5
|No

|REDIS_URL
|If using Sidekiq as a queue adapter for processing background jobs, a Redis database is needed. Sidekiq uses this env var if defined, if not defaults to `localhost:6379`. Please refer to https://github.com/mperham/sidekiq/wiki/Using-Redis[Sidekiq documentation] for more information.
|5
|No

|===

Please take care that all these configurations would be the defaults but *some of these could also be changed on a Multitenant's System configuration* (for instance SMTP or OAUTH providers).

