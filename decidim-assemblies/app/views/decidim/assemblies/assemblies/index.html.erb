<% add_decidim_meta_tags(title: t("assemblies.index.title", scope: "decidim")) %>

<%
edit_link(
  decidim_admin_assemblies.assemblies_path,
  :read,
  :assembly_list
)
%>

<%= participatory_space_wrapper do %>
  <% if promoted_assemblies.any? %>
    <section id="highlighted-assemblies" class="row section">
      <h1 class="section-heading"><%= t("assemblies.index.promoted_assemblies", scope: "layouts.decidim") %></h1>
      <%= render partial: "promoted_assembly", collection: promoted_assemblies, as: :promoted_assembly %>
    </section>
  <% end %>

  <section id="assemblies-grid" class="section row collapse">
    <div class="row column">
      <div class="flex--sbe">
        <h2 class="section-heading collapse"><%= t("assemblies.order_by_assemblies.assemblies", scope: "layouts.decidim", count: collection.count) %></h2>
        <div class="inline-filters">
          <%= order_selector available_orders, i18n_scope: "decidim.assemblies.filter" %>
          <%# render partial: "decidim/assemblies/order_by_assemblies" %>
        </div>
      </div>
      <hr class="reset mt-s mb-s">
    </div>
    <div class="row small-up-1 medium-up-2 large-up-3 card-grid">
      <%= render(collection) %>
    </div>
  </section>

  <section id="assemblies-chart" class="row column section">
    <div class="row column">
      <h2 class="section-heading"><%= t("assemblies.index.organizational_chart", scope: "layouts.decidim") %></h2>
      <article id="orgchart-<%= SecureRandom.hex(5) %>" class="card orgchart js-orgchart absolutes" data-url="<%= decidim_assemblies.assemblies_path(format: :json) %>">
        <button class="medium-1 m-s top left button small hollow invisible js-reset-orgchart"><%= t("assemblies.index.reset_chart", scope: "layouts.decidim") %></button>
      </article>
    </div>
  </section>
<% end %>
<%= javascript_include_tag "decidim/orders" %>
