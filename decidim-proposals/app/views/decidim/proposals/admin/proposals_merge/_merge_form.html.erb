<div class="form__wrapper">
  <div class="card pt-4">
    <div class="card-section">

      <div class="row column pb-4">
        <%= merge_form.translated :text_field, :title, autofocus: true, class: "js-hashtags", hashtaggable: true, aria: { label: :title } %>
      </div>
      <div class="row column">
        <%= merge_form.translated :editor, :body, hashtaggable: true, aria: { label: :body } %>
      </div>
      <% if @form.meetings %>
        <div class="meeting-fields">
          <div class="row column">
            <%= merge_form.check_box :created_in_meeting, label: t(".created_in_meeting") %>
          </div>
          <div class="row column" id="proposal_meeting">
            <%= merge_form.select :meeting_id,
                            options_for_select(@form.meetings&.map { |meeting| [present(meeting).title(html_escape: true), meeting.id] }, selected: meetings_as_authors_selected ),
                            { include_blank: true, label: t(".select_a_meeting") },
                            { multiple: false, class: "chosen-select" } %>
          </div>
        </div>
      <% end %>
      <% if @form.geocoding_enabled? %>
        <div class="row column">
          <%= form.geocoding_field :address %>
        </div>
      <% end %>

      <% if component_settings.attachments_allowed? %>
        <%= render partial: "decidim/admin/shared/gallery", locals: { form: } %>
      <% end %>
      <% if component_settings.attachments_allowed? %>
        <div class="row column">
          <legend><%= t(".attachment_legend") %></legend>
          <%= form.fields_for :attachment, @form.attachment do |form| %>
            <%= form.text_field :title %>
            <%= form.upload :file, button_class: "button button__sm button__transparent-secondary" %>
            <% if params[:id].present? %>
              <% if proposal.documents.present? %>
                <%= form.hidden_field :id, value: proposal.documents.first.id %>
                <%= form.check_box :delete_file, label: t(".delete_attachment"), value: proposal.documents.first.id %>
              <% end %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<%= append_javascript_pack_tag "decidim_proposals_admin" %>
