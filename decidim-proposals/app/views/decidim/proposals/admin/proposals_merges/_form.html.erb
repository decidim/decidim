<div class="form__wrapper pt-0 h-screen">
  <div class="card">
    <div class="card-section">
      <% @form.proposal_ids.each do |id| %>
        <%= hidden_field_tag "proposal_ids[]", id %>
      <% end %>
      <div class="row column">
        <%= bulk_components_select((current_component.siblings + [current_component])) %>
      </div>
      <div class="row column pt-8">
        <%= form.translated :text_field, :title, autofocus: true, class: "js-hashtags", aria: { label: :title } %>
      </div>
      <div class="row column pt-8">
        <%= form.translated :editor, :body, hashtaggable: true, aria: { label: :body } %>
      </div>
      <% if @form.meetings %>
        <div class="meeting-fields">
          <div class="row column">
            <%= form.check_box :created_in_meeting, label: t(".created_in_meeting") %>
          </div>
          <div class="row column" id="proposals_merge_meeting">
            <%= form.select :meeting_id,
                            options_for_select(@form.meetings&.map { |meeting| [present(meeting).title(html_escape: true), meeting.id] }, selected: meetings_as_authors_selected ),
                            { include_blank: true, label: t(".select_a_meeting") },
                            { multiple: false, class: "chosen-select" } %>
          </div>
        </div>
      <% end %>
      <% if @form.geocoding_enabled? %>
        <div class="row column pt-8" id="proposals_merge_address">
          <%= form.geocoding_field :address %>
        </div>
      <% end %>
      <% if component_settings.attachments_allowed? %>
        <%= render partial: "decidim/admin/shared/gallery", locals: { form: } %>
      <% end %>
      <% if component_settings.attachments_allowed? %>
        <div class="row column pt-8">
          <legend><%= t(".attachment_legend") %></legend>
          <%= form.fields_for :attachment, @form.attachment do |form| %>
            <%= form.text_field :title %>
            <%= form.upload :file, button_class: "button button__sm button__transparent-secondary" %>
            <% if params[:id].present? %>
              <% if proposal.documents.present? %>
                <%= form.hidden_field :id, value: proposal.documents.first.id %>
                <%= form.check_box :delete_file, label: t(".delete_attachment"), value: proposal.documents.first.id %>
              <% end %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<%= append_javascript_pack_tag "decidim_proposals_admin" %>
