<% if current_user %>
  <% status = action_authorization(action) %>
  <div class="reveal" id="<%= action.underscore%>AuthorizationModal" data-reveal>
    <button class="close-button" data-close aria-label="Close modal"
            type="button">
      <span aria-hidden="true">&times;</span>
    </button>
    <% if status.reauthorize? %>
      <div class="reveal__header">
        <h3 class="reveal__title"><%= t('.incomplete.title') %></h3>
      </div>
      <p><%= t ".incomplete.explanation", authorization: t("#{status.handler_name}.name", scope: "decidim.authorization_handlers") %></p>
      <ul>
        <% status.data[:fields].each do |field| %>
          <li><strong><%= t("#{status.handler_name}.fields.#{field}", scope: "decidim.authorization_handlers") %></strong></li>
        <% end %>
      </ul>
      <div class="row">
        <div class="columns medium-8 medium-offset-2">
          <%= button_to t('.incomplete.reauthorize'), reauthorize_action_path(:vote), class: "button expanded" %>
        </div>
      </div>
      <div class="text-center">
        <button class="link" data-close><%=t ".incomplete.cancel" %></button>
      </div>
    <% elsif status.invalid? %>
      <div class="reveal__header">
        <h3 class="reveal__title"><%= t('.unauthorized.title') %></h3>
      </div>
      <p><%= t ".unauthorized.explanation", authorization: t("#{status.handler_name}.name", scope: "decidim.authorization_handlers") %></p>
      <ul>
        <% status.data[:fields].each do |field, value| %>
          <li><strong><%= t(".unauthorized.should_be", field: t("#{status.handler_name}.fields.#{field}", scope: "decidim.authorization_handlers"), value: value) %></strong></li>
        <% end %>
      </ul>
      <div class="row">
        <div class="columns medium-8 medium-offset-2">
          <button class="button expanded" data-close><%=t ".unauthorized.ok" %></button>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
