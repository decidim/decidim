<% provide(:title, translated_attribute(post.title)) %>

<% add_decidim_meta_tags({
  title: translated_attribute(post.title),
  description: translated_attribute(post.body),
  url: post_url(post.id)
}) %>

<%
  edit_link(
    resource_locator(post).edit,
    :update,
    :blogpost,
    blogpost: post
  )
%>

<%= render layout: "layouts/decidim/shared/layout_one_col" do %>

  <div class="grid grid-cols-8">
    <h1 class="h1 decorator my-12 col-start-2 col-span-6"><%= translated_attribute post.title %></h1>

    <%# TODO: Check if post.image is present %>
    <% if true %>
      <div class="col-span-8 rounded-xl overflow-hidden mb-8">
        <img src="https://www.fillmurray.com/640/360" class="w-full object-cover aspect-[3]">
      </div>
    <% end %>

    <div class="col-start-2 col-span-6 mb-24">
      <%# TODO: this cell should show only profile + date %>
      <% post_presenter = Decidim::Blogs::PostPresenter.new(post) %>
      <%= cell "decidim/author", post_presenter.author, from: post %>

      <div class="prose max-w-full">
        <%= decidim_sanitize_editor translated_attribute post.body %>
      </div>

      <div class="flex justify-between">
        <div class="flex items-center gap-2">
          <% if endorsements_enabled? %>
            <%= cell "decidim/endorsers_list", post %>
            <%= endorsement_buttons_cell(post) %>
          <% end %>

          <%= link_to "#comments", class: "button text-secondary white sm border" do %>
            <%= t("decidim.blogs.posts.show.comments") %>
            <%= icon "chat-1-line", class: "fill-current flex-none" %>
          <% end %>
        </div>

        <div class="flex items-center">
          <%= follow_button_for(post) %>

          <%# TODO: implement the share button %>
          <button class="button text-secondary white sm">
            Compartir
            <%= icon "share-line", class: "fill-current flex-none" %>
          </button>

          <%# TODO: implement the flag button %>
          <button class="button text-secondary white sm">
            Denunciar
            <%= icon "flag-line", class: "fill-current flex-none" %>
          </button>
        </div>
      </div>
    </div>

    <div class="col-span-8 bg-border">
      <%= attachments_for post %>
      <%= comments_for post %>
    </div>
  </div>

<% end %>
